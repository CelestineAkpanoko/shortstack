generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id          String   @id @default(uuid())
  clerkUserId String   @unique
  email       String   @unique
  name        String?
  imageURL    String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  classes     Class[]
}

model Class {
  id         String       @id @default(cuid())
  name       String
  emoji      String
  code       String       @unique
  cadence    String?
  day        String?
  time       String?
  grade      String?
  userId     String
  createdAt  DateTime     @default(now())
  updatedAt  DateTime     @updatedAt
  user       User         @relation(fields: [userId], references: [clerkUserId], onDelete: Cascade)
  LessonPlan LessonPlan[]
  students   Student[]

  @@index([userId])
}

model Student {
  id          String   @id @default(cuid())
  firstName   String
  lastName    String
  password    String
  classId     String
  progress    Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  schoolEmail String   @unique
  class       Class    @relation(fields: [classId], references: [code], onDelete: Cascade)

  @@index([classId])
  @@index([schoolEmail])
}

model Assignment {
  id          String       @id
  name        String
  description String?
  dueDate     DateTime?
  createdAt   DateTime     @default(now())
  updatedAt   DateTime
  LessonPlan  LessonPlan[] @relation("LessonPlanAssignments")
}

model File {
  id          String       @id
  name        String
  description String?
  url         String?
  createdAt   DateTime     @default(now())
  updatedAt   DateTime
  LessonPlan  LessonPlan[] @relation("LessonPlanFiles")
}

model LessonPlan {
  id          String       @id
  name        String       @unique
  description String?
  classId     String
  createdAt   DateTime     @default(now())
  updatedAt   DateTime
  Class       Class        @relation(fields: [classId], references: [code], onDelete: Cascade)
  Assignment  Assignment[] @relation("LessonPlanAssignments")
  File        File[]       @relation("LessonPlanFiles")
}
